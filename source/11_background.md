## Background

FeliCa was first commercially used in 1997 in Hong Kong. People used Octopus for transportation, electronic payments and access control. At first, it was using DES encryption. In June 2011, Sony announced the new generation of FeliCa contactless IC chip. It supports AES encryption in Reader/Writer authentication and communication path encryption. === Ref{https://www.sony.net/SonyInfo/News/Press/201106/11-066E/} === As a result, there are 3 types of FeliCa cards: DES card, AES card and AES/DES card. DES card is the first generation and supports *Authentication1* and *Authentication2*. AES card is newer and supports *Authentication1 v2* and *Authentication2 v2*. AES/DES card supports both versions of authentications. In this project, only DES card is concerned. More specifically, only *Authentication1* version 1 is concerned. 

A FeliCa card card has 4 states, known as "Mode": i.e. Mode0, Mode1, Mode2 and Mode3. Execution of commands provided by a card is limited by mode. === Ref{http://www.proxmark.org/files/Documents/13.56%20MHz%20-%20FeliCa/card_usersmanual_2.0.pdf} {Part 4.3} === When the card is powered on by approaching a card reader/writer, it transits to Mode0. This is the default mode and very limited actions are allowed. In order to read from or write to a specific area, normally encrypted and seperated from other areas, mutual authentication must be performed. Mutual authentication is seperated into 2 parts: *Authentication1* and *Authentication2*. After successful of Authentication1, the card transits to Mode1. After Authentication2, it transits to Mode2. Only then allows read and write operations. After successful execution of Area, Service registration or System Separation commands, the card transitions to Mode3. However, this is beyond the scope of this project. 

![Mode transition diagram (DES)](source/img/felica_des_mode_diagram.png)

======= Delete this ????? =======
In order to perform actions such as read or write, mutual authentication must be carried out. The keys used for encryption are changed dynamically every time the mutual authentication is performed. === Ref{https://www.sony.net/Products/felica/about/scheme.html#scheme06} === However, there are no public API and documentation about the implementation available. It does not entirely follow ISO/IEC 14443 (Contactless Card) and ISO/IEC 18092 (NFC) but introduced a new standard - *JIS: X6319-4*. The JIS X6319-4 standard is also called NFC-F, as opposed to NFC-A and NFC-B, which relate to ISO/IEC 14443A and ISO/IEC 14443B. === ref{https://www.sony.net/Products/felica/NFC/} === 

Since the implementation of authentication is confidential, I would like to find out more about it by reverse engineering the function. In this project, I am going to analyse *Authentication1*, which used triple DES (3DES) encryption. It is the first half of mutual authentication.

